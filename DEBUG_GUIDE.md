# Pico USB随机鼠标 故障排查指南

## 🔧 调试步骤

### 1. **查看串口输出**
如果设备有任何问题，请查看串口输出：
```bash
# macOS/Linux
sudo screen /dev/tty.usbmodem* 115200

# 或者使用 minicom
sudo minicom -D /dev/tty.usbmodem* -b 115200
```

### 2. **LED状态指示**
- **LED闪烁3次后熄灭**：初始化完成，等待USB连接
- **LED常亮**：未连接到USB或USB断开
- **LED缓慢闪烁**：正常运行，正在发送鼠标移动

### 3. **预期的串口输出**
```
=== Pico 随机USB鼠标启动 ===
初始化时间: 1234 ms
硬件初始化完成
等待USB连接...
随机数种子: 12345
>>> USB 已连接到电脑! <<<
[2500 ms] 随机移动: X=1, Y=-1
[2500 ms] USB HID 报告发送成功
```

### 4. **故障诊断信息**
每1秒会输出调试信息：
```
=== 调试信息 [3000 ms] ===
USB连接状态: 已连接
HID就绪状态: 就绪
LED状态: 亮
=====================
```

## 🚨 常见问题和解决方案

### 问题1：设备未出现在系统中
**症状**：LED常亮，调试输出显示"USB连接状态: 未连接"

**解决方案**：
1. 检查USB线缆是否良好
2. 尝试不同的USB端口
3. 重新烧录固件：`ninja flash`
4. 检查电脑是否识别到未知设备

### 问题2：鼠标被识别但不移动
**症状**：系统显示有鼠标设备，但鼠标指针不动

**解决方案**：
1. 检查调试输出是否显示"USB HID 报告发送成功"
2. 如果没有，可能是HID接口未正确初始化
3. 尝试重启设备

### 问题3：随机性太强，移动太快
**症状**：鼠标移动过于剧烈

当前的移动参数：
- 移动范围：-1 到 +1（每0.5秒）
- 移动频率：每0.5秒改变方向
- 20%概率停止不动

如需调整，修改以下代码：
```c
// 在 generate_random_movement() 函数中
mouse_x = (int8_t)(rand() % 7 - 3);  // 改为 % 3 - 1 进行更小幅度的移动
mouse_y = (int8_t)(rand() % 7 - 3);
```

### 问题4：无法查看串口输出
如果无法连接串口，可能有以下原因：
1. 系统占用串口设备
2. USB权限问题
3. 驱动程序冲突

**替代方案**：
通过LED闪烁模式判断状态：
- 短闪3次：初始化完成
- 长亮：等待USB连接
- 频繁闪烁：正常运行

## 🧪 测试验证

### 1. **连接测试**
1. 连接Pico到电脑
2. 观察LED应该闪烁3次后熄灭
3. 系统应该显示"RandomUSBMouse"设备

### 2. **功能测试**
1. 打开一个空白文档或画图软件
2. 观察鼠标指针是否随机移动
3. LED应该每0.5秒闪烁一次

### 3. **断开重连测试**
1. 拔掉USB线
2. 重新插入
3. 验证设备是否正常重新连接

## 🔍 进一步调试

如果问题仍然存在，请：

1. **记录串口输出**，特别是启动时的信息
2. **检查系统设备管理器**，查看是否有UNKNOWN设备
3. **尝试不同的操作系统**（Windows/macOS/Linux）
4. **检查VID/PID冲突**，当前使用VID=0xCAFE PID=0x0001

## 📞 联系支持

如果以上步骤都无法解决问题，请提供：
1. 完整的串口输出
2. 操作系统版本
3. 设备管理器截图
4. Pico板型号信息